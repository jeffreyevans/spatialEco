<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pseudo-absence random samples — pseudo.absence • spatialEco</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Pseudo-absence random samples — pseudo.absence" />
<meta property="og:description" content="Generates pseudo-absence samples based on density estimate 
             of known locations" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialEco</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3-7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jeffreyevans/spatialEco/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pseudo-absence random samples</h1>
    <small class="dont-index">Source: <a href='https://github.com/jeffreyevans/spatialEco/blob/master/R/pseudo.absence.R'><code>R/pseudo.absence.R</code></a></small>
    <div class="hidden name"><code>pseudo.absence.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates pseudo-absence samples based on density estimate 
             of known locations</p>
    </div>

    <pre class="usage"><span class='fu'>pseudo.absence</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>n</span>,
  window <span class='op'>=</span> <span class='st'>"hull"</span>,
  Mask <span class='op'>=</span> <span class='cn'>NULL</span>,
  s <span class='op'>=</span> <span class='cn'>NULL</span>,
  sigma <span class='op'>=</span> <span class='st'>"Scott"</span>,
  wts <span class='op'>=</span> <span class='cn'>NULL</span>,
  KDE <span class='op'>=</span> <span class='cn'>FALSE</span>,
  gradient <span class='op'>=</span> <span class='fl'>1</span>,
  p <span class='op'>=</span> <span class='cn'>NULL</span>,
  edge <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An sp class SpatialPointsDataFrame or SpatialPoints object</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Number of random samples to generate</p></td>
    </tr>
    <tr>
      <th>window</th>
      <td><p>Type of window (hull OR extent), overridden if mask provided</p></td>
    </tr>
    <tr>
      <th>Mask</th>
      <td><p>Optional rasterLayer class mask raster. The resolution of the 
density estimate will match mask.</p></td>
    </tr>
    <tr>
      <th>s</th>
      <td><p>Optional resolution passed to window argument. Caution should be 
used due to long processing times associated with high 
resolution. In contrast, coarse resolution can exclude 
known points.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>Bandwidth selection method for KDE, default is 'Scott'. 
Options are 'Scott', 'Stoyan', 'Diggle', 'likelihood', 
and 'geometry'</p></td>
    </tr>
    <tr>
      <th>wts</th>
      <td><p>Optional vector of weights corresponding to point pattern</p></td>
    </tr>
    <tr>
      <th>KDE</th>
      <td><p>save KDE raster (TRUE/FALSE)</p></td>
    </tr>
    <tr>
      <th>gradient</th>
      <td><p>A scaling factor applied to the sigma parameter used to 
adjust the gradient decent of the density estimate. The 
default is 1, for no adjustment (downweight &lt; 1 | upweight &gt; 1)</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>Minimum value for probability distribution (must be &gt;  0)</p></td>
    </tr>
    <tr>
      <th>edge</th>
      <td><p>Apply Diggle edge correction (TRUE/FALSE)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list class object with the following components:</p><ul>
<li><p>sample SpatialPointsDataFrame containing random samples</p></li>
<li><p>kde sp RasterLayer class of KDE estimates (IF KDE = TRUE)</p></li>
<li><p>sigma Selected bandwidth of KDE</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The window type creates a convex hull by default or, optionally, uses the 
maximum extent (envelope). If a mask is provided the kde will represent 
areas defined by the mask and defines the area that pseudo absence data 
will be generated.</p>
<p>Available bandwidth selection methods are:</p><ul>
<li><p>Scott (Scott 1992), Scott's Rule for Bandwidth Selection (1st order)</p></li>
<li><p>Diggle (Berman &amp; Diggle 1989), Minimize the mean-square error via cross 
        validation (2nd order)</p></li>
<li><p>likelihood (Loader 1999), Maximum likelihood cross validation (2nd order)</p></li>
<li><p>geometry, Bandwidth is based on simple window geometry (1st order)</p></li>
<li><p>Stoyan (Stoyan &amp; Stoyan 1995), Based on pair-correlation function 
       (strong 2nd order)</p></li>
<li><p>User defined numeric distance bandwidth</p></li>
</ul>

<p>Note; resulting bandwidth can vary widely by method. the 'diggle' method 
is intended for selecting bandwidth representing 2nd order spatial variation 
whereas the 'scott' method will represent 1st order trend. the 'geometry' approach 
will also represent 1st order trend. For large datasets, caution should be used with 
the 2nd order 'likelihood' approach, as it is slow and computationally expensive. 
finally, the 'stoyan' method will produce very strong 2nd order results.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Berman, M. and Diggle, P. (1989) Estimating weighted integrals of the second-order 
  intensity of a spatial point process. Journal of the Royal Statistical Society, 
  series B 51, 81-92.</p>
<p>Fithian, W &amp; T. Hastie (2013) Finite-sample equivalence in statistical models for 
  presence-only data. Annals of Applied Statistics 7(4): 1917-1939</p>
<p>Hengl, T., H. Sierdsema, A. Radovic, and A. Dilo (2009) Spatial prediction of species 
  distributions from occurrence-only records: combining point pattern analysis, 
  ENFA and regression-kriging. Ecological Modelling, 220(24):3499-3511</p>
<p>Loader, C. (1999) Local Regression and Likelihood. Springer, New York.</p>
<p>Scott, D.W. (1992) Multivariate Density Estimation. Theory, Practice and Visualization. 
  New York, Wiley.</p>
<p>Stoyan, D. and Stoyan, H. (1995) Fractals, random shapes and point fields: methods of 
  geometrical statistics. John Wiley and Sons.</p>
<p>Warton, D.i., and L.C. Shepherd (2010) Poisson Point Process Models Solve the Pseudo-Absence 
  Problem for Presence-only Data in Ecology. The Annals of Applied Statistics, 4(3):1383-1402</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Jeffrey S. Evans  &lt;jeffrey_evans@tnc.org&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/raster'>raster</a></span><span class='op'>)</span> 
 <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/edzer/sp/'>sp</a></span><span class='op'>)</span>
 <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span>
 <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>meuse.grid</span><span class='op'>)</span>
   <span class='fu'><a href='https://rdrr.io/pkg/raster/man/xyFromCell.html'>coordinates</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span> <span class='op'>=</span> <span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>   
   <span class='fu'><a href='https://rdrr.io/pkg/raster/man/xyFromCell.html'>coordinates</a></span><span class='op'>(</span><span class='va'>meuse.grid</span><span class='op'>)</span> <span class='op'>=</span> <span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>
   <span class='fu'><a href='https://rdrr.io/pkg/raster/man/projection.html'>proj4string</a></span><span class='op'>(</span><span class='va'>meuse.grid</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sp/man/CRS-class.html'>CRS</a></span><span class='op'>(</span><span class='st'>"+init=epsg:28992"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Discarded datum Amersfoort in Proj4 definition</span></div><div class='input'>   <span class='fu'><a href='https://rdrr.io/pkg/sp/man/gridded-methods.html'>gridded</a></span><span class='op'>(</span><span class='va'>meuse.grid</span><span class='op'>)</span> <span class='op'>=</span> <span class='cn'>TRUE</span>
   <span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='va'>meuse.grid</span><span class='op'>)</span>

   <span class='co'># Using a raster mask   </span>
   <span class='va'>pa</span> <span class='op'>&lt;-</span> <span class='fu'>pseudo.absence</span><span class='op'>(</span><span class='va'>meuse</span>, n<span class='op'>=</span><span class='fl'>100</span>, window<span class='op'>=</span><span class='st'>'hull'</span>, KDE<span class='op'>=</span><span class='cn'>TRUE</span>, Mask <span class='op'>=</span> <span class='va'>r</span>, 
                        sigma<span class='op'>=</span><span class='st'>'Diggle'</span>, s<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span> 
     <span class='va'>col.br</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'blue'</span>,<span class='st'>'yellow'</span><span class='op'>)</span><span class='op'>)</span>
       <span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>pa</span><span class='op'>$</span><span class='va'>kde</span>, col<span class='op'>=</span><span class='fu'>col.br</span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'>         <span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>meuse</span>, pch<span class='op'>=</span><span class='fl'>20</span>, cex<span class='op'>=</span><span class='fl'>1</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'>           <span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>pa</span><span class='op'>$</span><span class='va'>sample</span>, col<span class='op'>=</span><span class='st'>'red'</span>, pch<span class='op'>=</span><span class='fl'>20</span>, cex<span class='op'>=</span><span class='fl'>1</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'>             <span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>'top'</span>, legend<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Presence'</span>, <span class='st'>'Pseudo-absence'</span><span class='op'>)</span>, 
                    pch<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>,<span class='fl'>20</span><span class='op'>)</span>,col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'black'</span>,<span class='st'>'red'</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='pseudo.absence-1.png' alt='' width='700' height='433' /></div><div class='input'>
 <span class='co'># With clustered data</span>
 <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/edzer/sp/'>sp</a></span><span class='op'>)</span>
 <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://spatstat.org/'>spatstat.core</a></span><span class='op'>)</span>
 <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>bei</span><span class='op'>)</span>
   <span class='va'>trees</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://r-spatial.github.io/sf/reference/coerce-methods.html'>as</a></span><span class='op'>(</span><span class='va'>bei</span>, <span class='st'>'SpatialPoints'</span><span class='op'>)</span>
     <span class='va'>trees</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/sp/man/SpatialPoints.html'>SpatialPointsDataFrame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/sp/man/coordinates.html'>coordinates</a></span><span class='op'>(</span><span class='va'>trees</span><span class='op'>)</span>, 
                         <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>ID<span class='op'>=</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>trees</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> 
       <span class='va'>trees.abs</span> <span class='op'>&lt;-</span> <span class='fu'>pseudo.absence</span><span class='op'>(</span><span class='va'>trees</span>, n<span class='op'>=</span><span class='fl'>100</span>, window<span class='op'>=</span><span class='st'>'extent'</span>, KDE<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
 
 <span class='va'>col.br</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'blue'</span>,<span class='st'>'yellow'</span><span class='op'>)</span><span class='op'>)</span>
   <span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>trees.abs</span><span class='op'>$</span><span class='va'>kde</span>, col<span class='op'>=</span><span class='fu'>col.br</span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='input'>    <span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>trees</span>, pch<span class='op'>=</span><span class='fl'>20</span>, cex<span class='op'>=</span><span class='fl'>0.50</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'>       <span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>trees.abs</span><span class='op'>$</span><span class='va'>sample</span>, col<span class='op'>=</span><span class='st'>'red'</span>, pch<span class='op'>=</span><span class='fl'>20</span>, cex<span class='op'>=</span><span class='fl'>1</span>, add<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='input'>         <span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span><span class='op'>(</span><span class='st'>'top'</span>, legend<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Presence'</span>, <span class='st'>'Pseudo-absence'</span><span class='op'>)</span>, 
                pch<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>20</span>,<span class='fl'>20</span><span class='op'>)</span>,col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'black'</span>,<span class='st'>'red'</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='pseudo.absence-2.png' alt='' width='700' height='433' /></div><div class='input'>     
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jeffrey S. Evans.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


